<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sistem Disiplin SMK Sikuati II</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icons/icon-192.png">
  <meta name="theme-color" content="#0B5ED7">
  <link rel="stylesheet" href="styles.css">
  <script src="config.js"></script>
</head>
<body>
  <header>
    <div class="left">
      <h1>Sistem Disiplin SMK Sikuati II</h1>
      <div class="meta">
        <span id="roleBadge" class="pill">Peranan: —</span>
        <span id="userBadge" class="pill">Guru: —</span>
      </div>
    </div>
    <div class="status">
      <span id="cloudStatus" class="badge offline">Offline</span>
      <button id="syncBtn" title="Paksa Sync">Sync</button>
      <button id="notifBtn" title="Benarkan Notifikasi">Notifikasi</button>
      <button id="profileBtn" title="Tukar Peranan / Nama">Profil</button>
      <button id="backendBtn" title="Tetapan Pangkalan Data">Backend</button>
    </div>
  </header>

  <main>
    <section class="card">
      <h2>Tambah Laporan Cepat</h2>
      <form id="reportForm">
        <div class="grid">
          <label>Nama Pelajar
            <input type="text" id="nama" required placeholder="cth: Ali bin Abu" />
          </label>
          <label>Kelas
            <input type="text" id="kelas" required placeholder="cth: 2 Kola" />
          </label>
          <label>Jenis Kesalahan
            <select id="jenis" required>
              <option value="">— pilih —</option>
              <option>Lewat ke kelas</option>
              <option>Tiada buku / peralatan</option>
              <option>Berbual / mengganggu PdP</option>
              <option>Telefon bimbit</option>
              <option>Ponteng kelas</option>
              <option>Pakaian tidak kemas</option>
              <option>Lain-lain</option>
            </select>
          </label>
          <label>Catatan
            <input type="text" id="catatan" placeholder="cth: kali ke-2 minggu ini" />
          </label>
          <label>Tarikh
            <input type="date" id="tarikh" />
          </label>
          <label>Masa
            <input type="time" id="masa" />
          </label>
        </div>
        <div class="actions">
          <button type="submit">Simpan Laporan</button>
          <button type="button" id="resetBtn" class="ghost">Kosongkan</button>
        </div>
      </form>
      <p class="hint">* Data disimpan <b>offline</b> & <b>auto-sync</b> ke pangkalan data sekolah bila ada internet.</p>
    </section>

    <section class="card">
      <h2>Carian & Senarai Laporan (Sekolah)</h2>
      <div class="toolbar">
        <input type="search" id="search" placeholder="Cari nama / kelas / jenis..." />
        <select id="filterKelas">
          <option value="">— Semua kelas —</option>
        </select>
        <select id="filterGuru">
          <option value="">— Semua guru —</option>
        </select>
        <button id="exportBtn">Export CSV (paparan)</button>
        <button id="adminOnly" class="ghost" style="display:none">Fungsi Disiplin</button>
      </div>
      <div id="stats" class="stats"></div>
      <table id="table">
        <thead>
          <tr>
            <th>Tarikh</th>
            <th>Masa</th>
            <th>Nama</th>
            <th>Kelas</th>
            <th>Kesalahan</th>
            <th>Catatan</th>
            <th>Guru</th>
            <th>Kiraan Amaran</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>
  </main>

  <!-- Profil -->
  <div id="profileModal" class="modal">
    <div class="modal-content">
      <h3>Profil Pengguna</h3>
      <label>Nama Guru
        <input type="text" id="guruNama" placeholder="cth: Cikgu Aminah" />
      </label>
      <label>Peranan
        <select id="guruPeranan">
          <option value="guru">Guru</option>
          <option value="guru_disiplin">Guru Disiplin</option>
        </select>
      </label>
      <label>E-mel (pilihan)
        <input type="email" id="guruEmail" placeholder="cth: disiplin@smk.edu.my" />
      </label>
      <div class="actions">
        <button id="saveProfile">Simpan</button>
        <button id="closeProfile" class="ghost">Tutup</button>
      </div>
    </div>
  </div>

  <!-- Backend URL -->
  <div id="backendModal" class="modal">
    <div class="modal-content">
      <h3>Tetapan Pangkalan Data (Google Apps Script)</h3>
      <p>1) Tampal <b>Web App URL</b> dari Apps Script di bawah, contoh:<br><code>https://script.google.com/macros/s/AKfycbx.../exec</code></p>
      <label>Web App URL
        <input type="url" id="endpointUrl" placeholder="https://script.google.com/macros/s/.../exec" />
      </label>
      <small class="mute">Disimpan dalam peranti ini dan digunakan untuk sync.</small>
      <div class="actions">
        <button id="saveBackend">Simpan URL</button>
        <button id="closeBackend" class="ghost">Tutup</button>
      </div>
    </div>
  </div>

  <footer>
    <small>v2.4 • Multi-peranan • Auto-sync (onload, online, 30s, visibility) • Notifikasi • Backend setup dalam app.</small>
  </footer>

  <script src="app.js"></script>
</body>
</html>
